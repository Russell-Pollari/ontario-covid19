_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[14],{"7Xy9":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vaccinations",function(){return t("t8Fg")}])},t8Fg:function(e,a,t){"use strict";t.r(a);var n=t("HALo"),r=t("z7pX"),i=t("vJKn"),s=t.n(i),l=t("rg98"),c=t("q1tI"),o=t.n(c),u=t("iae6"),_=t("ofer"),d=t("7oih"),f=t("Cmmz"),v=t("uM61"),p=o.a.createElement,h=function(e){var a=e.data,t=void 0===a?[]:a;if(!t.length)return null;var n=t[t.length-1],r=n.total_individuals_fully_vaccinated,i=n.total_doses_administered-2*r,s=(2*(12932471-r)-i)/n.new_vaccines_rolling_average,l=(12932471-r-i)/n.new_vaccines_rolling_average;return p(v.a,{title:"Vaccinations at a glance"},p("ul",null,p("li",null,p("strong",null,Math.round((i+r)/12932471*100*100)/100,"%")," ","of the ",p("em",null,"eligible")," population of Ontario has had at least one shot.*"),p("li",null,p("strong",null,Math.round(r/12932471*100*100)/100,"%")," ","of the ",p("em",null,"eligible")," population of Ontario is fully vaccinated.*"),p("li",null,"At the current average pace of ",p("strong",null,n.new_vaccines_rolling_average.toLocaleString())," shots per day. We can deliver a single dose to every eligible person in ",p("strong",null,Math.round(l)," days.")," And reach full vaccination in ",p("strong",null,Math.round(s)," days.*"))),p("div",{className:"mt16 f12"},"*Eligible population: Everyone 12 and older based on estimates from Statistics Canada on July 1st 2020.",p("br",null),"*These numbers are all back-of-the-envolope estimates. Don't take them as fact."))},m=t("XkeK"),g=o.a.createElement,y=function(e){return e.toLocaleString()},b=function(e){return"".concat(e>=0?"+":"").concat(y(e))},x=[{label:"Date",key:"date_string"},{label:"Total doses administered",key:"total_doses_administered",formatValue:y},{label:"Daily vaccines",key:"previous_day_total_doses_administered",formatValue:b,highlight:"positive"},{label:"7 day average",key:"new_vaccines_rolling_average",formatValue:b,highlight:"positive"},{label:"Total people fully vaccinated",key:"total_individuals_fully_vaccinated",formatValue:y}],w=function(e){var a=e.dataSource,t=void 0===a?[]:a;return g(m.a,{title:"Status of Vaccinations in Ontario",data:t,columns:x})},D=o.a.createElement,S=function(e){return"".concat(e,"%")},E=[{label:" ",key:"type",isBold:!0},{label:"One Dose Effectiveness",key:"partial",formatValue:S,align:"center"},{label:"Two Dose Effectiveness",key:"full",formatValue:S,align:"center"}],O=function(e){var a=e.dataSource,t=void 0===a?[]:a,n=D(c.Fragment,null,"* Effectiveness was calculated using the method detailed by the ",D("a",{href:"https://www.cdc.gov/csels/dsepd/ss1978/lesson3/section6.html"},"CDC here"),". ",D("br",null),"* This Data is not age adjusted, which means the effectiveness is underestimated.");return D(m.a,{title:"Vaccine Effectiveness (last 7 days)",data:t,columns:E,paginationEnabled:!1,footnote:n})},j=t("StWE"),k=function(e){return"number"===typeof e?e:Number((e||"0").replace(/,/g,""))},P=function(){return new Promise((function(e){Object(j.a)("https://data.ontario.ca/api/3/action/datastore_search?resource_id=8a89caa9-511c-4568-af89-7f2174b4378c&limit=100000",(function(a){var t=a.result.records;t.sort((function(e,a){return new Date(e.report_date)-new Date(a.report_date)}));for(var n=[0,0,0,0,0,0,0],r=[],i=1;i<t.length;i++){var s=t[i],l=new Date(s.report_date).getTime(),c=t[i-1];r.push(c);var o=new Date(c.report_date);for(o.setDate(o.getDate()+1);o.getTime()<l;){var u=Object.assign({},c,{report_date:o.toISOString().replace(/\.\d+Z/,"")});r.push(u),o.setDate(o.getDate()+1)}}r.push(t[t.length-1]);var _=0,d=0;r.map((function(e){var a=e.report_date,t=e.total_doses_administered,r=e.previous_day_total_doses_administered,i=e.total_doses_in_fully_vaccinated_individuals,s=e.total_individuals_fully_vaccinated;e.date_string=new Date(a).toLocaleString("en-us",{month:"short",day:"numeric"}),e.total_doses_administered=k(t),e.previous_day_total_doses_administered=k(r),e.total_individuals_fully_vaccinated=k(s);var l=k(i),c=k(2*(e.total_individuals_fully_vaccinated-l/2)),o=k(c-d);d=c;var u=Math.floor((l-c)/2),f=u-_;_=u;var v=e.previous_day_total_doses_administered-(f+o);e.previous_day_one_shot_doses_administered=o,e.previous_day_second_doses_administered=f,e.previous_day_first_doses_administered=v,n.shift(),n.push(e.previous_day_total_doses_administered);var p=n.reduce((function(e,a){return a+e}),0);return e.new_vaccines_rolling_average=Math.round(p/7),e})),e(r)}))}))},V=function(e){return"number"===typeof e?e:Number((e||"0").replace(/,/g,""))},M=function(){return new Promise((function(e){Object(j.a)("https://data.ontario.ca/api/3/action/datastore_search?resource_id=775ca815-5028-4e9b-9dd4-6975ff1be021&limit=11&sort=_id desc",(function(a){var t=a.result.records.filter((function(e){return"Undisclosed_or_missing"!=e.Agegroup}));t.sort((function(e,a){return e._id-a._id})),t.map((function(e){var a=e.Agegroup,t=e.Percent_at_least_one_dose,n=e.Percent_fully_vaccinated;return e.Agegroup=function(e){switch(e){case"12-17yrs":return"12-17";case"18-29yrs":return"18-29";case"30-39yrs":return"30s";case"40-49yrs":return"40s";case"50-59yrs":return"50s";case"60-69yrs":return"60s";case"70-79yrs":return"70s";case"Adults_18plus":return"18+";case"Ontario_12plus":return"12+";default:return e}}(a),e.Percent_at_least_one_dose=100*V(t),e.Percent_fully_vaccinated=100*V(n),e.percent_partially_vaccinated=e.Percent_at_least_one_dose-e.Percent_fully_vaccinated,e.percent_not_vaccinated=100-e.Percent_at_least_one_dose,e})),e(t)}))}))},N=function(e){return"https://data.ontario.ca/api/3/action/datastore_search?resource_id=".concat(e,"&limit=100000")},T=function(e){return"number"===typeof e?e:Number((e||"0").replace(/,/g,""))},A=function(e){return"string"===typeof e?new Date(e).toLocaleDateString("en-US"):e instanceof Date?e.toLocaleDateString("en-US"):""},C=function(){var e=Object(l.a)(s.a.mark((function e(){var a,t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t=[],n=[],e.next=5,new Promise((function(e){var a=N("8a89caa9-511c-4568-af89-7f2174b4378c");Object(j.a)(a,(function(a){var t=a.result.records;t.sort((function(e,a){return new Date(e.report_date)-new Date(a.report_date)}));for(var n=[],r=1;r<t.length;r++){var i=t[r],s=new Date(i.report_date).getTime(),l=t[r-1];n.push(l);var c=new Date(l.report_date);for(c.setDate(c.getDate()+1);c.getTime()<s;){var o=Object.assign({},l,{report_date:c.toISOString().replace(/\.\d+Z/,"")});n.push(o),c.setDate(c.getDate()+1)}}n.push(t[t.length-1]);var u=[];n.forEach((function(e){var a=e.report_date,t=e.total_individuals_fully_vaccinated,n=e.total_individuals_at_least_one,r=new Date(a);r.setDate(r.getDate()+14);var i={date:A(r),full_vax_individuals:T(t),partial_vax_individuals:T(n)-T(t),unvax_individuals:14789778-T(n)};u.push(i)})),e(u)}))})).then((function(e){return a=e}));case 5:return e.next=7,new Promise((function(e){var a=N("274b819c-5d69-4539-a4db-f2950794138c");Object(j.a)(a,(function(a){var t=a.result,n=[];t.records.forEach((function(e){var a=e.date,t=e.icu_unvac,r=e.icu_partial_vac,i=e.icu_full_vac,s=e.hospitalnonicu_unvac,l=e.hospitalnonicu_partial_vac,c=e.hospitalnonicu_full_vac,o={date:A(a),icu_unvax:T(t),icu_partial_vax:T(r),icu_full_vax:T(i),hosp_unvax:T(s)+T(t),hosp_partial_vax:T(l)+T(r),hosp_full_vax:T(c)+T(i)};n.push(o)})),e(n)}))})).then((function(e){return t=e}));case 7:return e.next=9,new Promise((function(e){var a=N("eed63cf2-83dd-4598-b337-b288c0a89a16");Object(j.a)(a,(function(a){var t=a.result,n=[];t.records.forEach((function(e){var a=e.Date,t=e.covid19_cases_unvac,r=e.covid19_cases_partial_vac,i=e.covid19_cases_full_vac,s={date:A(a),cases_unvax:T(t),cases_partial_vax:T(r),cases_full_vax:T(i)};n.push(s)})),e(n)}))})).then((function(e){return n=e}));case 9:return e.abrupt("return",new Promise((function(e){var r=[];n.forEach((function(e){var n,i,s,l,c,o,u,_,d,f,v=e.date,p=t.find((function(e){return e.date==v})),h=a.find((function(e){return e.date==v})),m=e.cases_unvax/h.unvax_individuals*1e6,g=e.cases_partial_vax/h.partial_vax_individuals*1e6,y=e.cases_full_vax/h.full_vax_individuals*1e6,b=100*(1-g/m),x=100*(1-y/m);null!=p&&(n=p.hosp_unvax/h.unvax_individuals*1e6,l=100*(1-(i=p.hosp_partial_vax/h.partial_vax_individuals*1e6)/n),c=100*(1-(s=p.hosp_full_vax/h.full_vax_individuals*1e6)/n),o=p.icu_unvax/h.unvax_individuals*1e6,d=100*(1-(u=p.icu_partial_vax/h.partial_vax_individuals*1e6)/o),f=100*(1-(_=p.icu_full_vax/h.full_vax_individuals*1e6)/o));var w={date:new Date(v).toLocaleString("en-us",{month:"short",day:"numeric"}),cases_unvax_per_mil:m,cases_partial_vax_per_mil:g,cases_full_vax_per_mil:y,hosp_unvax_per_mil:n,hosp_partial_vax_per_mil:i,hosp_full_vax_per_mil:s,icu_unvax_per_mil:o,icu_partial_vax_per_mil:u,icu_full_vax_per_mil:_,cases_partial_effect:b,cases_full_effect:x,hosp_partial_effect:l,hosp_full_effect:c,icu_partial_effect:d,icu_full_effect:f};r.push(w)}));var i=0,s=0,l=0,c=0,o=0,u=0,_=r.filter((function(e){return null!=e.hosp_unvax_per_mil})).slice(-7);r.slice(-7).forEach((function(e){o+=e.cases_partial_effect,u+=e.cases_full_effect})),_.forEach((function(e){i+=e.icu_partial_effect,s+=e.icu_full_effect,l+=e.hosp_partial_effect,c+=e.hosp_full_effect}));var d=Math.round(i/7),f=Math.round(s/7),v=Math.round(l/7),p=Math.round(c/7),h=Math.round(o/7),m=Math.round(u/7);e({all:r,avg:[{type:"ICU",partial:d,full:f},{type:"Hospitalization",partial:v,full:p},{type:"Cases",partial:h,full:m}]})})));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=t("mPjd"),X=t("/NAY"),B=o.a.createElement;a.default=function(){var e=Object(c.useState)([]),a=e[0],t=e[1],i=Object(c.useState)([]),o=i[0],v=i[1],p=Object(c.useState)({}),m=p[0],g=p[1],y=Object(c.useState)(!0),b=y[0],x=y[1],D=function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M().then(v);case 2:return e.next=4,P().then(t);case 4:return e.next=6,C().then(g);case 6:x(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){D()}),[]);var S=[{title:"Summary",href:"#"}].concat(Object(r.a)(L.e.map((function(e){var a=e.title;return{title:a,href:"#".concat(a)}})))),E=function(e){switch(e){case X.a.vaccinatedByAge:return o;case X.a.casesByVax:return m.all;case X.a.hospitalByVax:case X.a.icuByVax:return m.all.filter((function(e){return null!=e.hosp_unvax_per_mil}));case X.a.totalDoses:case X.a.totalVaccinated:case X.a.dailyDoses:return a;default:return[]}};return B(d.a,{menuItems:S},B("div",{className:"ph16"},B(_.a,{variant:"h4"},"Covid-19 Vaccinations in Ontario"),b?B("p",{className:"tc"},B("strong",null,"Hold tight.. just fetching the latest data"),B("div",null,B(u.a,null))):B(c.Fragment,null,B(h,{data:a}),B(w,{dataSource:a}),B(O,{dataSource:m.avg}),L.e.map((function(e,a){return B(f.a,Object(n.a)({key:a,dataSource:E(e.id)},e))})))))}}},[["7Xy9",0,2,1,3,4,5,6]]]);