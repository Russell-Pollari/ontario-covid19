_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[10],{RNiq:function(t,e,a){"use strict";a.r(e);var n=a("HALo"),o=a("q1tI"),i=a.n(o),r=a("3aVm"),s=i.a.createElement,l=function(t){var e=t.dataSource,a=void 0===e?[]:e,n=Object(o.useState)([]),i=n[0],r=n[1],l=Object(o.useState)(4),c=l[0],u=l[1];Object(o.useEffect)((function(){var t=a.slice(-c).reverse();r(t)}),[a,c]);var d=Object(o.useCallback)((function(){u((function(t){return t+4}))}),[u]),h=Object(o.useCallback)((function(){u((function(t){return t>4?t-4:t}))}),[u]);return s("div",{className:"tl chart-container"},s("table",{className:"w-100"},s("thead",null,s("tr",null,s("th",null,"Date"),s("th",{colSpan:"2"},s("a",{href:"#Active cases"},"Active cases")),s("th",{colSpan:"2"},s("a",{href:"#Total cases"},"Cases")),s("th",{colSpan:"2"},s("a",{href:"#Total deaths"},"Deaths")),s("th",{colSpan:"2"},s("a",{href:"#Patients hospitalized"},"Hospitalizations")),s("th",{colSpan:"2"},s("a",{href:"#Patients in ICU"},"Patients in ICU")),s("th",{colSpan:"2"},"Resolved"))),s("tbody",null,i.map((function(t,e){return s("tr",{key:e},s("td",null,t.date_string),s("td",null,t.active_cases.toLocaleString()),s("td",null,"(",t.new_active_cases>=0&&"+",t.new_active_cases.toLocaleString(),")"),s("td",null,t["Total Cases"].toLocaleString()),s("td",null,"(+",t.new_cases.toLocaleString(),")"),s("td",null,t.Deaths.toLocaleString()),s("td",null,"(+",t.new_deaths.toLocaleString(),")"),s("td",null,t["Number of patients hospitalized with COVID-19"].toLocaleString()),s("td",null,"(",t.new_hospital>=0&&"+",t.new_hospital.toLocaleString(),")"),s("td",null,t["Number of patients in ICU with COVID-19"].toLocaleString()),s("td",null,"(",t.new_icu>=0&&"+",t.new_icu.toLocaleString(),")"),s("td",null,t.Resolved.toLocaleString()),s("td",null,"(",t.new_resolved>=0&&"+",t.new_resolved.toLocaleString(),")"))})))),s("button",{type:"button",onClick:d,style:{backgroundColor:"white",color:"black",border:"2px solid #008CBA",marginRight:"5px"}},"+"),s("button",{type:"button",onClick:h,style:{backgroundColor:"white",color:"black",border:"2px solid #008CBA"}},"-"))},c=a("M/4y"),u=a("NGxS"),d=function(t){Object(u.a)("https://data.ontario.ca/api/3/action/datastore_search?resource_id=ed270bb8-340b-41f9-a7c6-e8ef587e6d11&limit=1000",(function(e){var a=e.result.records;a.sort((function(t,e){return new Date(t["Reported Date"])-new Date(e["Reported Date"])}));var n=[0,0,0,0,0,0,0],o=[0,0,0,0,0,0,0],i=[0,0,0,0,0,0,0],r=[0,0,0,0,0,0,0],s=0,l=0,c=0,u=0,d=0,h=0;a.map((function(t){t.new_cases=t["Total Cases"]-s,t.new_deaths=Math.max(t.Deaths-l,0),t.icu_no_ventilator=t["Number of patients in ICU with COVID-19"]-t["Number of patients in ICU on a ventilator with COVID-19"],t.date_string=new Date(t["Reported Date"]).toLocaleString("en-us",{month:"short",day:"numeric"}),t.active_cases=t["Total Cases"]-t.Resolved-t.Deaths,t.new_active_cases=t.active_cases-c,t.new_resolved=t.Resolved-u,t.new_hospital=t["Number of patients hospitalized with COVID-19"]-d,t.new_icu=t["Number of patients in ICU with COVID-19"]-h,t.percent_positive=(t.new_cases/t["Total tests completed in the last day"]*100).toFixed(2),(t.percent_positive>100||isNaN(t.percent_positive))&&(t.percent_positive=0),r.shift(),r.push(Number(t.percent_positive||0)),t.tests_positive_rolling_average=(r.reduce((function(t,e){return e+t}),0)/7).toFixed(2),i.shift(),i.push(t["Total tests completed in the last day"]||0),t.tests_rolling_average=Math.round(i.reduce((function(t,e){return e+t}),0)/7),n.shift(),n.push(t.new_cases);var e=n.reduce((function(t,e){return e+t}),0);t.new_cases_rolling_average=Math.round(e/7),o.shift(),o.push(t.new_deaths);var a=o.reduce((function(t,e){return e+t}),0);return t.new_deaths_rolling_average=Math.round(a/7),h=t["Number of patients in ICU with COVID-19"],d=t["Number of patients hospitalized with COVID-19"],s=t["Total Cases"],l=t.Deaths,u=t.Resolved,c=t.active_cases,t})),t(a)}))},h=function(){return new Promise((function(t){Object(u.a)("https://data.ontario.ca/api/3/action/datastore_search?resource_id=8a89caa9-511c-4568-af89-7f2174b4378c&limit=100000",(function(e){var a=e.result.records;a.sort((function(t,e){return new Date(t.report_date)-new Date(e.report_date)}));for(var n=[0,0,0,0,0,0,0],o=[],i=1;i<a.length;i++){var r=a[i],s=new Date(r.report_date).getTime(),l=a[i-1];o.push(l);var c=new Date(l.report_date);for(c.setDate(c.getDate()+1);c.getTime()<s;){var u=Object.assign({},l,{report_date:c.toISOString().replace(/\.\d+Z/,"")});o.push(u),c.setDate(c.getDate()+1)}}o.push(a[a.length-1]),o.map((function(t){var e=t.report_date,a=t.total_doses_administered,o=t.previous_day_doses_administered;t.date_string=new Date(e).toLocaleString("en-us",{month:"short",day:"numeric"}),t.total_doses_administered=Number(a.replace(",","")),t.previous_day_doses_administered=Number(o.replace(",","")),n.shift(),n.push(t.previous_day_doses_administered);var i=n.reduce((function(t,e){return e+t}),0);return t.new_vaccines_rolling_average=Math.round(i/7),t})),t(o)}))}))},p=a("I5Uv"),_=a("5UwH"),f=i.a.createElement;e.default=function(){var t=Object(o.useState)([]),e=t[0],a=t[1],i=Object(o.useState)([]),s=i[0],u=i[1],v=Object(o.useState)(!0),b=v[0],g=v[1];return Object(o.useEffect)((function(){h().then(u),d((function(t){a(t),g(!1)})),Object(p.a)()}),[]),b?f("div",{classes:"tc pa16"},f("h2",null,"Simple dashboard visualizing Ontario's Covid-19 data."),f("p",null,"Hold tight.. just fetching the latest data")):f(r.a,null,f("h2",null,"Simple dashboard visualizing Ontario's Covid-19 data."),f("p",null,f("a",{href:"/ontario-covid19/phus"},"View data for each PHU ->")),f("ul",null,f("li",null,f("strong",null,"Update (2021/03/10):")," Added ",f("a",{href:"/ontario-covid19/phus"},"a page")," to filter stats by public health unit (work in progress)"),f("li",null,f("strong",null,"Update (2021/03/07):")," Added some features to the Summary table and added a 7 day moving average for daily vaccines. Thanks ",f("a",{href:"https://github.com/IsaacBerman",target:"_blank"},"IsaacBerman")," for the pull requests!"),f("li",null,f("strong",null,"Update (2021/02/20):")," Added a plot showing daily vaccinations."),f("li",null,f("strong",null,"Update (2021/02/07):")," Some minor prettifications. Thanks ",f("a",{href:"https://github.com/TikiTDO",target:"_blank"},"TikiTDO")," for the pull requests!"),f("li",null,f("strong",null,"Update (2021/01/07):")," Added a plot to track vaccinations.")),f("p",null,"Want to contribute to this dashboard? Fork it on ",f("a",{href:"https://github.com/Russell-Pollari/ontario-covid19"},"GitHub"),"."),f("p",null,f("a",{href:"/ontario-covid19/about"},"About this dashboard")),f(l,{dataSource:e}),_.b.map((function(t,e){return f(c.a,Object(n.a)({key:e,dataSource:s,syncId:"vaccineCharts"},t))})),_.a.map((function(t,a){return f(c.a,Object(n.a)({key:a,dataSource:e,syncId:"syncCharts"},t))})))}},vlRD:function(t,e,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a("RNiq")}])}},[["vlRD",0,1,3,4]]]);