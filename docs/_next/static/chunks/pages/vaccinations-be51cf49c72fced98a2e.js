_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[14],{"7Xy9":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vaccinations",function(){return t("t8Fg")}])},t8Fg:function(e,a,t){"use strict";t.r(a);var n=t("HALo"),r=t("z7pX"),i=t("vJKn"),l=t.n(i),s=t("rg98"),o=t("q1tI"),u=t.n(o),c=t("iae6"),_=t("ofer"),d=t("7oih"),f=t("Cmmz"),v=t("uM61"),p=u.a.createElement,h=function(e){var a=e.data,t=void 0===a?[]:a;if(!t.length)return null;var n=t[t.length-1],r=n.total_individuals_fully_vaccinated,i=n.total_doses_administered-2*r,l=(2*(12932471-r)-i)/n.new_vaccines_rolling_average,s=(12932471-r-i)/n.new_vaccines_rolling_average;return p(v.a,{title:"Vaccinations at a glance"},p("ul",null,p("li",null,p("strong",null,Math.round((i+r)/12932471*100*100)/100,"%")," ","of the ",p("em",null,"eligible")," population of Ontario has had at least one shot.*"),p("li",null,p("strong",null,Math.round(r/12932471*100*100)/100,"%")," ","of the ",p("em",null,"eligible")," population of Ontario is fully vaccinated.*"),p("li",null,"At the current average pace of ",p("strong",null,n.new_vaccines_rolling_average.toLocaleString())," shots per day. We can deliver a single dose to every eligible person in ",p("strong",null,Math.round(s)," days.")," And reach full vaccination in ",p("strong",null,Math.round(l)," days.*"))),p("div",{className:"mt16 f12"},"*Eligible population: Everyone 12 and older based on estimates from Statistics Canada on July 1st 2020.",p("br",null),"*These numbers are all back-of-the-envolope estimates. Don't take them as fact."))},m=t("XkeK"),g=u.a.createElement,y=function(e){return e.toLocaleString()},b=function(e){return"".concat(e>=0?"+":"").concat(y(e))},x=[{label:"Date",key:"date_string"},{label:"Total doses administered",key:"total_doses_administered",formatValue:y},{label:"Daily vaccines",key:"previous_day_total_doses_administered",formatValue:b,highlight:"positive"},{label:"7 day average",key:"new_vaccines_rolling_average",formatValue:b,highlight:"positive"},{label:"Total people fully vaccinated",key:"total_individuals_fully_vaccinated",formatValue:y}],w=function(e){var a=e.dataSource,t=void 0===a?[]:a;return g(m.a,{title:"Status of Vaccinations in Ontario",data:t,columns:x})},D=u.a.createElement,S=function(e){return"".concat(e,"%")},E=[{label:" ",key:"type",isBold:!0},{label:"One Dose Effectiveness",key:"partial",formatValue:S,align:"center"},{label:"Two Dose Effectiveness",key:"full",formatValue:S,align:"center"}],O=function(e){var a=e.dataSource,t=void 0===a?[]:a,n=D(o.Fragment,null,"* Effectiveness was calculated using the method detailed by the ",D("a",{href:"https://www.cdc.gov/csels/dsepd/ss1978/lesson3/section6.html"},"CDC here"),". ",D("br",null),"* This Data is not age adjusted, which means the effectiveness is underestimated.");return D(m.a,{title:"Vaccine Effectiveness (last 7 days)",data:t,columns:E,paginationEnabled:!1,footnote:n})},j=t("StWE"),P=function(e){return"number"===typeof e?e:Number((e||"0").replace(/,/g,""))},k=function(){return new Promise((function(e){Object(j.a)("https://data.ontario.ca/api/3/action/datastore_search?resource_id=8a89caa9-511c-4568-af89-7f2174b4378c&limit=100000",(function(a){var t=a.result.records;t.sort((function(e,a){return new Date(e.report_date)-new Date(a.report_date)}));for(var n=[0,0,0,0,0,0,0],r=[],i=1;i<t.length;i++){var l=t[i],s=new Date(l.report_date).getTime(),o=t[i-1];r.push(o);var u=new Date(o.report_date);for(u.setDate(u.getDate()+1);u.getTime()<s;){var c=Object.assign({},o,{report_date:u.toISOString().replace(/\.\d+Z/,"")});r.push(c),u.setDate(u.getDate()+1)}}r.push(t[t.length-1]);var _=0,d=0;r.map((function(e){var a=e.report_date,t=e.total_doses_administered,r=e.previous_day_total_doses_administered,i=e.total_doses_in_fully_vaccinated_individuals,l=e.total_individuals_fully_vaccinated;e.date_string=new Date(a).toLocaleString("en-us",{month:"short",day:"numeric"}),e.total_doses_administered=P(t),e.previous_day_total_doses_administered=P(r),e.total_individuals_fully_vaccinated=P(l);var s=P(i),o=P(2*(e.total_individuals_fully_vaccinated-s/2)),u=P(o-d);d=o;var c=Math.floor((s-o)/2),f=c-_;_=c;var v=e.previous_day_total_doses_administered-(f+u);e.previous_day_one_shot_doses_administered=u,e.previous_day_second_doses_administered=f,e.previous_day_first_doses_administered=v,n.shift(),n.push(e.previous_day_total_doses_administered);var p=n.reduce((function(e,a){return a+e}),0);return e.new_vaccines_rolling_average=Math.round(p/7),e})),e(r)}))}))},V=function(e){return"number"===typeof e?e:Number((e||"0").replace(/,/g,""))},M=function(){return new Promise((function(e){Object(j.a)("https://data.ontario.ca/api/3/action/datastore_search?resource_id=775ca815-5028-4e9b-9dd4-6975ff1be021&limit=10&sort=_id desc",(function(a){var t=a.result.records.filter((function(e){return"Undisclosed_or_missing"!=e.Agegroup}));t.sort((function(e,a){return e._id-a._id})),t.map((function(e){var a=e.Agegroup,t=e.Percent_at_least_one_dose,n=e.Percent_fully_vaccinated;return e.Agegroup=function(e){switch(e){case"12-17yrs":return"12-17";case"18-29yrs":return"18-29";case"30-39yrs":return"30s";case"40-49yrs":return"40s";case"50-59yrs":return"50s";case"60-69yrs":return"60s";case"70-79yrs":return"70s";case"Adults_18plus":return"18+";default:return e}}(a),e.Percent_at_least_one_dose=100*V(t),e.Percent_fully_vaccinated=100*V(n),e.percent_partially_vaccinated=e.Percent_at_least_one_dose-e.Percent_fully_vaccinated,e.percent_not_vaccinated=100-e.Percent_at_least_one_dose,e})),e(t)}))}))},A=function(e){return"https://data.ontario.ca/api/3/action/datastore_search?resource_id=".concat(e,"&limit=100000")},N=function(e){return"number"===typeof e?e:Number((e||"0").replace(/,/g,""))},T=function(e){return"string"===typeof e?new Date(e).toLocaleDateString("en-US"):e instanceof Date?e.toLocaleDateString("en-US"):""},C=function(){var e=Object(s.a)(l.a.mark((function e(){var a,t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t=[],n=[],e.next=5,new Promise((function(e){var a=A("8a89caa9-511c-4568-af89-7f2174b4378c");Object(j.a)(a,(function(a){var t=a.result.records;t.sort((function(e,a){return new Date(e.report_date)-new Date(a.report_date)}));for(var n=[],r=1;r<t.length;r++){var i=t[r],l=new Date(i.report_date).getTime(),s=t[r-1];n.push(s);var o=new Date(s.report_date);for(o.setDate(o.getDate()+1);o.getTime()<l;){var u=Object.assign({},s,{report_date:o.toISOString().replace(/\.\d+Z/,"")});n.push(u),o.setDate(o.getDate()+1)}}n.push(t[t.length-1]);var c=[];n.forEach((function(e){var a=e.report_date,t=e.total_individuals_fully_vaccinated,n=e.total_individuals_at_least_one,r=new Date(a);r.setDate(r.getDate()+14);var i={date:T(r),full_vax_individuals:N(t),partial_vax_individuals:N(n)-N(t),unvax_individuals:14789778-N(n)};c.push(i)})),e(c)}))})).then((function(e){return a=e}));case 5:return e.next=7,new Promise((function(e){var a=A("274b819c-5d69-4539-a4db-f2950794138c");Object(j.a)(a,(function(a){var t=a.result,n=[];t.records.forEach((function(e){var a=e.date,t=e.icu_unvac,r=e.icu_partial_vac,i=e.icu_full_vac,l=e.hospitalnonicu_unvac,s=e.hospitalnonicu_partial_vac,o=e.hospitalnonicu_full_vac,u={date:T(a),icu_unvax:N(t),icu_partial_vax:N(r),icu_full_vax:N(i),hosp_unvax:N(l)+N(t),hosp_partial_vax:N(s)+N(r),hosp_full_vax:N(o)+N(i)};n.push(u)})),e(n)}))})).then((function(e){return t=e}));case 7:return e.next=9,new Promise((function(e){var a=A("eed63cf2-83dd-4598-b337-b288c0a89a16");Object(j.a)(a,(function(a){var t=a.result,n=[];t.records.forEach((function(e){var a=e.Date,t=e.covid19_cases_unvac,r=e.covid19_cases_partial_vac,i=e.covid19_cases_full_vac,l={date:T(a),cases_unvax:N(t),cases_partial_vax:N(r),cases_full_vax:N(i)};n.push(l)})),e(n)}))})).then((function(e){return n=e}));case 9:return e.abrupt("return",new Promise((function(e){var r=[];n.forEach((function(e){var n,i,l,s,o,u,c,_,d,f,v=e.date,p=t.find((function(e){return e.date==v})),h=a.find((function(e){return e.date==v})),m=e.cases_unvax/h.unvax_individuals*1e6,g=e.cases_partial_vax/h.partial_vax_individuals*1e6,y=e.cases_full_vax/h.full_vax_individuals*1e6,b=100*(1-g/m),x=100*(1-y/m);null!=p&&(n=p.hosp_unvax/h.unvax_individuals*1e6,s=100*(1-(i=p.hosp_partial_vax/h.partial_vax_individuals*1e6)/n),o=100*(1-(l=p.hosp_full_vax/h.full_vax_individuals*1e6)/n),u=p.icu_unvax/h.unvax_individuals*1e6,d=100*(1-(c=p.icu_partial_vax/h.partial_vax_individuals*1e6)/u),f=100*(1-(_=p.icu_full_vax/h.full_vax_individuals*1e6)/u));var w={date:new Date(v).toLocaleString("en-us",{month:"short",day:"numeric"}),cases_unvax_per_mil:m,cases_partial_vax_per_mil:g,cases_full_vax_per_mil:y,hosp_unvax_per_mil:n,hosp_partial_vax_per_mil:i,hosp_full_vax_per_mil:l,icu_unvax_per_mil:u,icu_partial_vax_per_mil:c,icu_full_vax_per_mil:_,cases_partial_effect:b,cases_full_effect:x,hosp_partial_effect:s,hosp_full_effect:o,icu_partial_effect:d,icu_full_effect:f};r.push(w)}));var i=0,l=0,s=0,o=0,u=0,c=0,_=r.filter((function(e){return null!=e.hosp_unvax_per_mil})).slice(-7);r.slice(-7).forEach((function(e){u+=e.cases_partial_effect,c+=e.cases_full_effect})),_.forEach((function(e){i+=e.icu_partial_effect,l+=e.icu_full_effect,s+=e.hosp_partial_effect,o+=e.hosp_full_effect}));var d=Math.round(i/7),f=Math.round(l/7),v=Math.round(s/7),p=Math.round(o/7),h=Math.round(u/7),m=Math.round(c/7);e({all:r,avg:[{type:"ICU",partial:d,full:f},{type:"Hospitalization",partial:v,full:p},{type:"Cases",partial:h,full:m}]})})));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=t("mPjd"),L=t("/NAY"),F=u.a.createElement;a.default=function(){var e=Object(o.useState)([]),a=e[0],t=e[1],i=Object(o.useState)([]),u=i[0],v=i[1],p=Object(o.useState)({}),m=p[0],g=p[1],y=Object(o.useState)(!0),b=y[0],x=y[1],D=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M().then(v);case 2:return e.next=4,k().then(t);case 4:return e.next=6,C().then(g);case 6:x(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){D()}),[]);var S=[{title:"Summary",href:"#"}].concat(Object(r.a)(B.e.map((function(e){var a=e.title;return{title:a,href:"#".concat(a)}})))),E=F(o.Fragment,null,"* This data is population adjusted. ",F("br",null),"* Population denominators are calculated based on daily dose history.",F("br",null),"* ",F("b",null,"Fully vaccinated")," = 14 days after 2nd dose",F("br",null),"* ",F("b",null,"Partially vaccinated")," = 14 days after 1st dose and <14 days after 2nd dose.");return F(d.a,{menuItems:S},F("div",{className:"ph16"},F(_.a,{variant:"h4"},"Covid-19 Vaccinations in Ontario"),b?F("p",{className:"tc"},F("strong",null,"Hold tight.. just fetching the latest data"),F("div",null,F(c.a,null))):F(o.Fragment,null,F(h,{data:a}),F(w,{dataSource:a}),F(O,{dataSource:m.avg}),B.e.map((function(e,t){var r,i,l,s,o,c;return e.id==L.a.vaccinatedByAge?(r=u,i="vaccineAgeCharts",l="band",s="%"):[L.a.casesByVax,L.a.hospitalByVax,L.a.icuByVax].includes(e.id)?(r=m.all,[L.a.hospitalByVax,L.a.icuByVax].includes(e.id)&&(r=r.filter((function(e){return null!=e.hosp_unvax_per_mil}))),l="band",c=!0,o=E):(r=a,i="vaccineCharts"),F(f.a,Object(n.a)({key:t,dataSource:r,syncId:i,xAxisScale:l,footnote:o,roundUpYAxisMax:c,valueSuffix:s},e))})))))}}},[["7Xy9",0,2,1,3,4,5,6]]]);